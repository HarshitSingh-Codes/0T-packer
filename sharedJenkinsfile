@Library("opstree-shared-library") _

def nginx = new org.opstree.template.nginx.nginx()
properties([
    parameters([
        booleanParam(name: 'runPacker', defaultValue: false, description: 'Run Packer'),
        string(name: 'packerFileName', defaultValue: 'nginxV2.pkr.hcl', description: 'Packer file name'),
        booleanParam(name: 'runTerraform', defaultValue: false, description: 'Run Terraform'),
        string(name: 'terraformDirPath', defaultValue: 'launch-template/', description: 'terraform code directory path'),        
    ])
])
node {
    
    def url = 'https://github.com/HarshitSingh-Codes/0T-packer.git'
    def creds = 'github-token'
    def branch = 'nginxV1.0'
    
    nginx.call(url, creds, branch, params.runPacker, params.packerFileName, params.runTerraform, params.terraformDirPath)
    
}
